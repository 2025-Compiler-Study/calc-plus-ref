# Calc Plus

[ANTLR4 Getting Started](https://github.com/antlr/antlr4/blob/master/doc/getting-started.md)의 Expr 예제를 기반으로 조금씩 확장한 언어다.

일반 프로그래밍 언어 개발을 바로 시작할 경우 상당히 많은 문법적 특성도 고려해야 하고, ANTLR 기반의 전단부 해석을 학습하기에 복잡한 부분이 많다.

이에 따라, 계산기 수준의 표현력인 최소한의 언어부터 시작해서, 변수 도입, 입출력까지만 지원하는 언어를 만들려 한다.

## Calc-0

언어 스펙은 예제의 Expr 문법에서 아주 조금 확장한다.

* L1의 문법 제목을 `Expr` 대신 `CalcPlus`로 변경
* L3~L6 마지막에 `#`으로 시작하는 부분의 Label이 추가
* L8이 원래 `NEWLINE : [\r\n]+ -> skip;`이었음
* L8을 `WS`로 변경하여, 스페이스와 탭도 무시할 수 있게 변경되었다. 

```antlrv4
grammar CalcPlus;
prog:	expr EOF ;
expr:	expr ('*'|'/') expr # MulDiv
    |	expr ('+'|'-') expr # AddSub
    |	INT                 # Int
    |	'(' expr ')'        # Parens
    ;
WS  : [ \t\r\n]+ -> skip;
INT : [0-9]+ ;
```

1. 코드는 단일 수식으로 끝난다.
2. 하지만 한 수식에는 여러 항의 연산이 가능하다.
3. 사칙연산에 대한 우선순위는 적용된다.
4. 괄호는 연산 우선순위를 강제하기 위해 사용된다.

### 구현 과제 #1

1. ANTLR CLI를 사용하여 lexer, parser 코드를 생성한다.
2. parser 생성 시 visitor, listener 패턴을 모두 지원할 수 있게 생성한다.
3. parser의 visitor, listener를 확장/구현한 구조체/클래스에서 계산을 수행한다.
4. parser의 결과물을 계산 결과로 반환한다.
5. 예시 입력으로 `10 + 2 * (5 - 9 / 3)`가 입력된다면 `14`를 계산해 내야 한다.

힌트: visitor 방식이 유리함. 하지만 listener로도 구현해 보길 바람.

### 구현 과제 #2

1. ANTLR CLI를 사용하여 lexer, parser 코드를 생성한다.
2. parser 생성 시 visitor, listener 패턴을 모두 지원할 수 있게 생성한다.
3. 현재 문법은 InFix 순서로 수식이 작성되어있는데, 이를 PostFix 순서로 변경해서 출력한다.
4. 예시 입력으로 `10 + 2 * (5 - 9 / 3)`가 입력된다면 `10 2 5 9 3 / - * +`가 출력되어야 한다.

힌트: listener 방식이 유리함. 하지만 visitor로도 구현해 보길 바람.

### 알아 둘 내용

1. `expr` 규칙에 `|`로 여럿 표시한 것은, `expr`이 여러 방식으로 해석될 수 있다는 뜻이다.
2. `expr`이 재귀적으로 쓰인 것은, 좌항/우항을 재귀적으로 활용할 수 있다는 뜻이다.
3. `expr` 규칙은 위에서부터 아래로 우선순위를 가진다. (현재 사칙연산 우선순위를 구현 중)
4. 괄호 규칙은 맨 아래 있지만, 괄호로 시작하는 규칙이 유일하므로, 의도대로 최우선 처리된다.
5. L3~L6 마지막에 `#`을 추가한 것은 각 규칙에 내부 라벨을 생성해준다. (해당 라벨 추가 시 어떤 메서드가 생성되는지 확인해 볼 것)